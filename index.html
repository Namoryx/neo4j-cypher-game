<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>쿼카와 함께하는 Cypher 게임</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" id="vite-entry" src="/src/main.jsx"></script>
    <script>
      const base = window.__APP_BASE__ || (location.pathname.includes('/neo4j-cyper-game/') ? '/neo4j-cyper-game/' : '/');

      function loadProdBundle() {
        const entry = document.getElementById('vite-entry');
        if (entry) {
          entry.remove();
        }

        const cssLink = document.createElement('link');
        cssLink.rel = 'stylesheet';
        cssLink.href = `${base}assets/app.css`;
        document.head.appendChild(cssLink);

        const prodScript = document.createElement('script');
        prodScript.type = 'module';
        prodScript.src = `${base}assets/app.js`;
        document.body.appendChild(prodScript);
      }

      window.addEventListener(
        'error',
        (event) => {
          const target = event?.target;
          if (target?.tagName === 'SCRIPT' && target.src && target.src.includes('/src/main.jsx')) {
            loadProdBundle();
          }
        },
        { once: true, capture: true }
      );
    </script>
  </body>
</html>
